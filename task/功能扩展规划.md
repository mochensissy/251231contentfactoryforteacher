# 内容工厂 Agent 功能扩展规划（精简版）

> 📅 更新日期: 2025-12-31
> 🎯 目标: 本地化运行的 AI 内容创作工具，聚焦短视频脚本生成和竞品分析

---

## 📋 功能范围

| 功能模块 | 状态 | 优先级 |
|:---------|:----:|:------:|
| 短视频脚本生成 | 📝 待开发 | 🥇 P0 |
| 竞品/对标账号分析 | 📝 待开发 | 🥈 P1 |
| ~~内容国际化~~ | ❌ 暂不需要 | - |
| ~~用户注册系统~~ | ❌ 暂不需要 | - |

---

## 一、短视频脚本生成 🎬

### 功能定位
生成 Bilibili 和 YouTube 短视频脚本，支持分镜建议，可预览编辑后导出使用。**不需要发布功能**。

### 核心功能

| 功能 | 描述 | 复杂度 |
|:-----|:-----|:------:|
| **脚本模板选择** | 预设多种视频类型模板（知识分享、产品测评、Vlog、口播、剧情等） | ⭐ |
| **AI 脚本生成** | 输入主题/关键词，AI 自动生成完整脚本 | ⭐⭐ |
| **分镜头建议** | 为脚本自动生成分镜头表（画面描述、时长、BGM 风格） | ⭐⭐⭐ |
| **实时预览** | 分栏预览脚本和分镜头建议 | ⭐⭐ |
| **在线编辑** | 支持直接编辑脚本和分镜内容 | ⭐⭐ |
| **导出功能** | 导出为 Markdown / Word / PDF / 分镜表格(Excel) | ⭐⭐ |
| **封面文案** | AI 生成视频封面标题和文案建议 | ⭐ |

### 脚本结构示例

```markdown
# 视频脚本：[标题]

## 基本信息
- 目标平台：Bilibili / YouTube
- 视频时长：60秒 / 3分钟 / 5分钟
- 视频类型：知识分享
- 目标受众：XXX

## 脚本正文

### 开场 Hook (0:00 - 0:10)
[吸引观众注意力的开场白]

### 正文部分 (0:10 - 2:30)
**第一段：XXX**
[内容...]

**第二段：XXX**
[内容...]

### 结尾 CTA (2:30 - 3:00)
[引导点赞关注的结尾]

---

## 分镜头建议

| 序号 | 时间段 | 画面描述 | 文案/口播 | BGM | 备注 |
|:----:|:------:|:---------|:----------|:----|:-----|
| 1 | 0:00-0:10 | 人物特写，震惊表情 | "你知道吗？..." | 悬疑风 | 用表情贴纸 |
| 2 | 0:10-0:30 | 屏幕录制 + 画中画 | "首先我们来看..." | 轻快节奏 | 加箭头标注 |
| ... | ... | ... | ... | ... | ... |
```

### 用户流程

```
选择视频类型 → 输入主题/关键词 → AI 生成脚本
                                      ↓
                              自动生成分镜头建议
                                      ↓
                              预览界面（左脚本/右分镜）
                                      ↓
                              在线编辑修改
                                      ↓
                              导出（MD/Word/PDF/Excel）
```

### 技术方案

**前端页面:**
- `/video-script` - 视频脚本创作主页面
- 使用 Tab 切换不同视频类型
- 分栏布局展示脚本和分镜

**后端 API:**
- `POST /api/video-script/generate` - 生成脚本
- `POST /api/video-script/storyboard` - 生成分镜建议
- `POST /api/video-script/export` - 导出功能

**依赖:**
- AI 生成: OpenAI GPT-4 / Claude / DeepSeek（支持中文效果更好）
- 导出 Word: docx 库
- 导出 PDF: puppeteer / html-pdf
- 导出 Excel: xlsx 库

### 数据库表设计

```prisma
// 视频脚本表
model VideoScript {
  id            Int       @id @default(autoincrement())
  title         String
  platform      String    // bilibili / youtube
  videoType     String    // 知识分享 / 产品测评 / Vlog 等
  duration      Int?      // 目标时长（秒）
  topic         String    // 输入的主题
  content       String    // 脚本正文（Markdown）
  storyboard    String?   // 分镜头数据（JSON）
  coverTitle    String?   // 封面标题建议
  createdAt     DateTime  @default(now())
  updatedAt     DateTime  @updatedAt

  @@map("video_scripts")
}
```

---

## 二、竞品/对标账号分析 📊

### 功能定位
爬取对标创作者的历史内容，AI 分析其内容策略，供学习参考。

### 核心功能

| 功能 | 描述 | 复杂度 |
|:-----|:-----|:------:|
| **账号管理** | 添加/管理要分析的对标账号 | ⭐ |
| **历史内容爬取** | 爬取账号的历史发文/视频列表 | ⭐⭐⭐ |
| **内容归档** | 存储标题、摘要、发布时间、互动数据 | ⭐⭐ |
| **AI 策略分析** | 分析发文规律、选题偏好、爆款特征 | ⭐⭐⭐ |
| **可视化报告** | 图表展示分析结果 | ⭐⭐ |
| **热门话题追踪** | 监控各平台热门话题 | ⭐⭐ |

### 支持平台

| 平台 | 采集方案 | 难度 | 备注 |
|:-----|:---------|:----:|:-----|
| **公众号** | Playwright 模拟 + 爬虫 | ⭐⭐⭐ | 需登录态 |
| **小红书** | Playwright + 代理池 | ⭐⭐⭐⭐ | 反爬较严 |
| **Twitter/X** | Nitter 镜像 / Apify | ⭐⭐⭐ | 有现成方案 |
| **Bilibili** | 官方 API + 补充爬取 | ⭐⭐ | 相对友好 |
| **YouTube** | YouTube Data API v3 | ⭐ | 官方免费 API |

### 分析维度

```
┌─────────────────────────────────────────────────────────────┐
│                    竞品分析报告                              │
├─────────────────────────────────────────────────────────────┤
│                                                             │
│  📊 发文频率分析                                             │
│  ├─ 平均发文频率：每周 3 篇                                  │
│  ├─ 最活跃时段：周二、周四 晚上 8-10 点                      │
│  └─ 近期趋势：发文频率增加 20%                               │
│                                                             │
│  🎯 选题方向分析                                             │
│  ├─ TOP5 高频关键词：AI、效率、工具、教程、变现              │
│  ├─ 内容类型分布：教程类 40%、评测类 30%、观点类 30%         │
│  └─ 热门系列：XXX系列 累计阅读 10w+                          │
│                                                             │
│  🔥 爆款特征识别                                             │
│  ├─ 标题特征：疑问句式、数字、情绪词                         │
│  ├─ 平均篇幅：1500-2000 字                                   │
│  └─ 爆款率：约 15% 的内容成为爆款                            │
│                                                             │
│  💡 AI 洞察建议                                              │
│  ├─ 建议选题：结合当前热点，可尝试 XXX 方向                  │
│  ├─ 发布时机：建议周二/周四晚 8 点发布                       │
│  └─ 内容形式：短内容互动率更高，建议控制在 1500 字以内       │
│                                                             │
└─────────────────────────────────────────────────────────────┘
```

### 用户流程

```
添加对标账号 → 选择平台/输入账号ID
                    ↓
              开始爬取历史内容
                    ↓
              内容列表展示（可按时间/互动量排序）
                    ↓
              AI 生成分析报告
                    ↓
              可视化图表展示
```

### 技术方案

**前端页面:**
- `/competitor-analysis` - 竞品分析主页面
- `/competitor-analysis/[id]` - 单账号详情页

**后端 API:**
- `POST /api/competitor/add` - 添加账号
- `POST /api/competitor/crawl` - 开始爬取
- `GET /api/competitor/[id]/articles` - 获取内容列表
- `POST /api/competitor/[id]/analyze` - AI 分析

**爬取技术栈:**
- Playwright（推荐）- 无头浏览器，模拟真实用户
- 代理池服务 - 应对反爬（可选）
- 定时任务 - 增量更新数据

### 数据库表设计

```prisma
// 对标账号表
model CompetitorAccount {
  id            Int       @id @default(autoincrement())
  platform      String    // wechat / xiaohongshu / twitter / bilibili / youtube
  accountId     String    // 平台账号ID
  accountName   String    // 账号名称
  accountUrl    String?   // 账号链接
  avatarUrl     String?   // 头像
  followerCount Int?      // 粉丝数
  lastCrawledAt DateTime? // 最后爬取时间
  createdAt     DateTime  @default(now())

  contents      CompetitorContent[]
  reports       CompetitorReport[]

  @@unique([platform, accountId])
  @@map("competitor_accounts")
}

// 对标内容表
model CompetitorContent {
  id            Int       @id @default(autoincrement())
  accountId     Int
  contentId     String    // 平台内容ID
  title         String
  summary       String?   // 摘要
  contentUrl    String?   // 原文链接
  publishedAt   DateTime? // 发布时间
  likeCount     Int?      // 点赞数
  commentCount  Int?      // 评论数
  shareCount    Int?      // 分享数
  viewCount     Int?      // 阅读/播放量
  createdAt     DateTime  @default(now())

  account       CompetitorAccount @relation(fields: [accountId], references: [id], onDelete: Cascade)

  @@unique([accountId, contentId])
  @@map("competitor_contents")
}

// 分析报告表
model CompetitorReport {
  id            Int       @id @default(autoincrement())
  accountId     Int
  reportType    String    // overview / topic / timing / style
  reportData    String    // JSON 格式的分析数据
  createdAt     DateTime  @default(now())

  account       CompetitorAccount @relation(fields: [accountId], references: [id], onDelete: Cascade)

  @@map("competitor_reports")
}
```

### 关于风险的说明

> [!NOTE]
> **主要风险是技术层面的"封号"，不是法律问题**
> 
> 您的使用场景（分析学习对标账号的公开内容策略）完全合规：
> - ✅ 只分析公开发布的内容
> - ✅ 不复制抄袭内容
> - ✅ 仅用于个人学习研究
> 
> **应对技术反爬的措施：**
> - 控制请求频率（模拟人类浏览速度）
> - 使用代理池（可选）
> - 模拟真实浏览器行为（Playwright）
> - 增加随机延迟

---

## 三、开发计划

### Phase 1: 短视频脚本生成 (1-2周)

- [ ] 创建视频脚本页面 `/video-script`
- [ ] 实现脚本生成 API
- [ ] 实现分镜头建议 API
- [ ] 分栏预览界面
- [ ] 在线编辑功能
- [ ] 导出功能（Markdown / Word / PDF）
- [ ] 数据库表和持久化

### Phase 2: 竞品分析基础 (2周)

- [ ] 创建竞品分析页面
- [ ] 账号管理功能
- [ ] Bilibili 内容爬取（最简单）
- [ ] YouTube API 集成
- [ ] 内容列表展示

### Phase 3: AI 分析能力 (1-2周)

- [ ] 基础统计分析（发文频率、时间分布）
- [ ] AI 内容策略分析
- [ ] 可视化报告（图表）
- [ ] 导出分析报告

### Phase 4: 扩展平台 (2-3周)

- [ ] 公众号内容爬取
- [ ] 小红书内容爬取
- [ ] Twitter/X 内容爬取
- [ ] 热门话题追踪

---

## 四、技术依赖总结

| 类别 | 依赖 | 用途 |
|:-----|:-----|:-----|
| AI | OpenAI / Claude / DeepSeek | 脚本生成、策略分析 |
| 爬虫 | Playwright | 无头浏览器爬取 |
| API | YouTube Data API v3 | YouTube 数据获取 |
| 导出 | docx, xlsx, puppeteer | 文档导出 |
| 图表 | Recharts (已有) | 数据可视化 |

---

## 五、下一步行动

请确认以上规划是否符合您的预期，我们可以立即开始实现：

1. **先做短视频脚本生成** - 快速出成果，2 周内可用
2. **再做竞品分析** - 从最简单的 Bilibili/YouTube 开始

您想先从哪个功能开始？
